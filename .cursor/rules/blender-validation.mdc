---
description: Validate Blender addon code by checking terminal for errors
globs: procedural_human/**/*.py
alwaysApply: false
---

# Blender Addon Validation

After modifying geometry node groups or operators, always verify they load correctly:

1. Check the Blender terminal for errors after addon reload
2. Look for patterns like:
   - `Error creating node group`
   - `KeyError` or `key "..." not found`
   - `AttributeError` 
   - `TypeError`

## Node Group Reload Pattern

Use `get_or_rebuild_node_group()` from `node_helpers.py` for all geometry node groups.
This pattern:
- Creates node groups on first call
- Clears and rebuilds on first call after addon reload (preserves references)
- Returns cached version on subsequent calls within the same session

```python
from procedural_human.geo_node_groups.node_helpers import get_or_rebuild_node_group

def create_my_node_group():
    group_name = "MyNodeGroup"
    group, needs_rebuild = get_or_rebuild_node_group(group_name)
    if not needs_rebuild:
        return group
    
    # Build interface and nodes...
    group.interface.new_socket(...)
    # ...
    return group
```

## Common Socket Issues (Blender 4.x)

Many nodes use indexed socket access instead of named access:

GeometryNodeCaptureAttribute:
- `inputs[0]` - Geometry input
- `inputs[1]` - Value to capture
- `outputs[0]` - Geometry output
- `outputs[1]` - Captured attribute

GeometryNodeMeshBoolean:
- `inputs[0]` - Mesh 1
- `inputs[1]` - Mesh 2

WARNING: Using wrong socket index will cause unexpected behavior or errors!

## Validation Workflow

1. Reload addon in Blender
2. Check terminal window for errors
3. If MCP server is running, use `ping_blender` to verify connection
4. Test node group creation by applying to an object
5. Use `validate_geometry` MCP tool to verify output has vertices/edges/faces
